# This workflow will build a .NET project
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-net

name: Quality gate npm pre-build

on:
  workflow_call:
    # inputs:
    #   skipTests:
    #     description: 'skipTests'
    #     type: string
    #   sonarQubeSC:
    #     description: 'sonarQubeSC'
    #     type: string

jobs:

  calling-workflow-quality-gate-pre-build:
    uses: MhpTransport/Ecovium.Github.Actions/.github/workflows/quality-gate-pre-build-template.yml@develop

  quality-gate-npm-prebuild:
    needs: calling-workflow-quality-gate-pre-build
    runs-on: ubuntu-latest
    env:
      template: ../partial-templates/variables.yml
      buildConfiguration: Release
    steps:
    - uses: actions/checkout@v4
    - name: Prepare Analysis
      # if: ${{ env.sonarQubeAvailable == 'true' && !github.event.inputs.skipTests }}
      run: |
        sonar-scanner \
          -Dsonar.projectKey=${{ env.sonarQubeProjectKey }} \
          -Dsonar.host.url=${{ env.sonarQubeEndpointUrl }} \
          -Dsonar.login=${{ env.sonarQubeApiUserToken }} \
          -Dsonar.javascript.lcov.reportPaths='${{ github.workspace }}/**/ClientApp/coverage/**/lcov-report/lcov.info'

